<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>菜单</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script>
        async function addToCart(itemId) {
            let quantity = document.getElementById('quantity_' + itemId).value;
            try {
                let response = await fetch('/add_to_cart', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: new URLSearchParams({
                        'item_id': itemId,
                        'quantity': quantity
                    })
                });

                if (response.ok) {
                    let data = await response.json();
                    console.log('Item added to cart:', data);
                    alert('Item added to cart');
                } else {
                    console.error('Error adding item to cart:', response.statusText);
                    alert('Error adding item to cart');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Error adding item to cart');
            }
        }
    </script>
</head>
<body>
    <header>
        <h1>菜单</h1>
    </header>

    <div class="container">
        <h2>菜单</h2>
        <ul class="menu-items">
            {% for item in menu_items %}
                <li>
                    <img src="{{ url_for('static', filename='images/' + item.image) }}" alt="{{ item.name }}">
                    <div>
                        <h2>{{ item.name }}</h2>
                        <p>{{ item.description }}</p>
                        <p>价格: {{ item.price }}元</p>
                        <label for="quantity_{{ item.id }}">数量:</label>
                        <input type="number" id="quantity_{{ item.id }}" name="quantity" min="1" value="1" style="width: 60px;">
                        <button onclick="addToCart({{ item.id }})">加入购物车</button>
                    </div>
                </li>
            {% endfor %}
        </ul>

        <!-- 返回主菜单和购物车按钮 -->
        <div class="navigation-buttons">
            <a href="{{ url_for('index') }}" class="back-to-menu">返回主菜单</a>
            <a href="{{ url_for('cart_view') }}" class="back-to-cart">返回购物车</a>
        </div>
    </div>
</body>
</html>
